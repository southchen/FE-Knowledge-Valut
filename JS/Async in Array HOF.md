[toc]

# Async funciton in Array HOF

## Reduce

```js
const sleep = (n) =>
  new Promise((res) => {
    console.log('set timer'); //同步执行
    setTimeout(() => {
      res();
      console.log('timer res');
    }, n);
  });
const arr = [1, 2, 3];
```

```js
async function test() {
  const startTime = new Date().getTime();
  const asyncRes = await arr.reduce(async (memo, e) => {
    console.log(e); //和遍历同步
    await sleep(10); //先执行内部的同步语句，将timer放到task queue，到时间后，res
	let res = await memo; //15ms
    console.log(res)
    return res + e;
  }, 0);
  console.log(`Took ${new Date().getTime() - startTime} ms`);
}
test();
console.log('sync')
```

**output:**

1 -> set timer  -> 2 ->  set timer ->  3  -> set timer  ->  **sync**
...sleeping...
timer res  -> 0 -> timer res   ->  1-> timer res ->3 



<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:266px;height:372px" viewBox="0 0 266 372"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="251" x="3" y="359.386">Async reduce with "await memo" last</text><path fill="#FFF" filter="url(#prefix__a)" d="M89 67.297H99V221.828H89zM156 81.297H166V250.96099999999998H156zM223 95.297H233V280.094H223z" stroke="#A80036" stroke-width="1.0"></path><path d="M38 51.297L38 298.094M94 51.297L94 298.094M161 51.297L161 298.094M228 51.297L228 298.094" stroke="#A80036" stroke-width="1.0" stroke-dasharray="5.0,5.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="11" y="47.995">reduce</text><ellipse cx="38.5" cy="19" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M34.5 7L40.5 2 38.5 7 40.5 12 34.5 7z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="11" y="310.089">reduce</text><ellipse cx="38.5" cy="329.391" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M34.5 317.391L40.5 312.391 38.5 317.391 40.5 322.391 34.5 317.391z" stroke="#A80036" stroke-width="1.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M76 16H108V46.297H76z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="83" y="35.995">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M76 297.094H108V327.391H76z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="83" y="317.089">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M143 16H175V46.297H143z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="150" y="35.995">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M143 297.094H175V327.391H143z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="150" y="317.089">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M210 16H242V46.297H210z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="217" y="35.995">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M210 297.094H242V327.391H210z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="217" y="317.089">e3</text><path fill="#FFF" filter="url(#prefix__a)" d="M89 67.297H99V221.828H89zM156 81.297H166V250.96099999999998H156zM223 95.297H233V280.094H223z" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M77 63.297L87 67.297 77 71.297 81 67.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M38.5 67.297L83 67.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M144 77.297L154 81.297 144 85.297 148 81.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M38.5 81.297L150 81.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M211 91.297L221 95.297 211 99.297 215 95.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M38.5 95.297L217 95.297" stroke="#A80036" stroke-width="1.0"></path><path d="M78 108.297v25h165v-15l-10-10H78" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M233 108.297v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="124" y="125.364">sleep(10)</text><path fill="#A80036" d="M177 159.563L167 163.563 177 167.563 173 163.563z" stroke="#A80036" stroke-width="1.0"></path><path d="M171 163.563L222 163.563" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="183" y="158.497">await</text><path fill="#A80036" d="M110 188.695L100 192.695 110 196.695 106 192.695z" stroke="#A80036" stroke-width="1.0"></path><path d="M104 192.695L155 192.695" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="116" y="187.629">await</text><path fill="#A80036" d="M144 217.828L154 221.828 144 225.828 148 221.828z" stroke="#A80036" stroke-width="1.0"></path><path d="M94 221.828L150 221.828" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="101" y="216.762">1</text><path fill="#A80036" d="M211 246.961L221 250.961 211 254.961 215 250.961z" stroke="#A80036" stroke-width="1.0"></path><path d="M161 250.961L217 250.961" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="168" y="245.895">3</text><path fill="#A80036" d="M49.5 276.094L39.5 280.094 49.5 284.094 45.5 280.094z" stroke="#A80036" stroke-width="1.0"></path><path d="M43.5 280.094L227 280.094" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="55.5" y="275.028">6</text></svg>

```js
async function test() {
  const startTime = new Date().getTime();
  const asyncRes = await arr.reduce(async (memo, e) => {
    console.log(e); //和遍历同步
    let res = await memo; //35ms sequetial
    console.log(res)
    await sleep(10); //settimer wait res
    return res + e;
  }, 0);
  console.log(`Took ${new Date().getTime() - startTime} ms`);
}
test();
console.log('sync')
```

**output:**

1 ->  2 -> 3   ->  **sync**

0-> set timer  -> timer res  ->1-> set timer  -> timer res  ->3 -> set timer  -> timer res

<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:275px;height:451px" viewBox="0 0 275 451"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="252" x="11.5" y="437.651">Async reduce with "await memo" first</text><path fill="#FFF" filter="url(#prefix__a)" d="M86 67.297H96V221.828H86zM153 81.297H163V290.094H153zM220 95.297H230V358.36H220z" stroke="#A80036" stroke-width="1.0"></path><path d="M35 51.297L35 376.359M91 51.297L91 376.359M158 51.297L158 376.359M225 51.297L225 376.359" stroke="#A80036" stroke-width="1.0" stroke-dasharray="5.0,5.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="8" y="47.995">reduce</text><ellipse cx="35.5" cy="19" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M31.5 7L37.5 2 35.5 7 37.5 12 31.5 7z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="8" y="388.354">reduce</text><ellipse cx="35.5" cy="407.656" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M31.5 395.656L37.5 390.656 35.5 395.656 37.5 400.656 31.5 395.656z" stroke="#A80036" stroke-width="1.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M73 16H105V46.297H73z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="80" y="35.995">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M73 375.359H105V405.656H73z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="80" y="395.354">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M140 16H172V46.297H140z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="147" y="35.995">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M140 375.359H172V405.656H140z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="147" y="395.354">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M207 16H239V46.297H207z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="214" y="35.995">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M207 375.359H239V405.656H207z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="214" y="395.354">e3</text><path fill="#FFF" filter="url(#prefix__a)" d="M86 67.297H96V221.828H86zM153 81.297H163V290.094H153zM220 95.297H230V358.36H220z" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M74 63.297L84 67.297 74 71.297 78 67.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M35.5 67.297L80 67.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M141 77.297L151 81.297 141 85.297 145 81.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M35.5 81.297L147 81.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M208 91.297L218 95.297 208 99.297 212 95.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M35.5 95.297L214 95.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M174 120.43L164 124.43 174 128.43 170 124.43z" stroke="#A80036" stroke-width="1.0"></path><path d="M168 124.43L219 124.43" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="180" y="119.364">await</text><path fill="#A80036" d="M107 149.563L97 153.563 107 157.563 103 153.563z" stroke="#A80036" stroke-width="1.0"></path><path d="M101 153.563L152 153.563" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="113" y="148.497">await</text><path d="M48 166.563v25h81v-15l-10-10H48" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M119 166.563v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="54" y="183.629">sleep(10)</text><path fill="#A80036" d="M141 217.828L151 221.828 141 225.828 145 221.828z" stroke="#A80036" stroke-width="1.0"></path><path d="M91 221.828L147 221.828" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="98" y="216.762">1</text><path d="M115 234.828v25h81v-15l-10-10h-71" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M186 234.828v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="121" y="251.895">sleep(10)</text><path fill="#A80036" d="M208 286.094L218 290.094 208 294.094 212 290.094z" stroke="#A80036" stroke-width="1.0"></path><path d="M158 290.094L214 290.094" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="165" y="285.028">3</text><path d="M182 303.094v25h81v-15l-10-10h-71" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M253 303.094v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="188" y="320.161">sleep(10)</text><path fill="#A80036" d="M46.5 354.359L36.5 358.359 46.5 362.359 42.5 358.359z" stroke="#A80036" stroke-width="1.0"></path><path d="M40.5 358.359L224 358.359" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="353.293">6</text></svg>



## map

https://advancedweb.hu/how-to-use-async-functions-with-array-map-in-javascript/

### Batch processing

```js
let group =  {
 	0: [30, 10, 20],
 	1: [20, 15, 20],
 	2: [10]
 }
const mapInGroups = (arr, iteratee, groupSize) => {
	return Object.values(groups)
		.reduce(async (memo, group) => [
			...(await memo),
			...(await Promise.all(group.map(iteratee)))
		], []);
};

const res = await mapInGroups(arr, async (v) => {
	console.log(`S ${v}`);
	await sleep(v);
	console.log(`F ${v}`);
	return v + 1;
}, 3);

```

### Parallel processing

```
const arr = [30, 10, 20, 20, 15, 20, 10];

// Bluebird promise
const res = await Promise.map(arr, async (v) => {
	console.log(`S ${v}`)
	await sleep(v);
	console.log(`F ${v}`);
	return v + 1;
}, {concurrency: 2});
console.log(res);
// 31,11,21,21,16,21,11
```

<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:235px;height:358px" viewBox="0 0 235 358"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="161" x="37.5" y="344.589">Controlled concurrency</text><path fill="#FFF" filter="url(#prefix__a)" d="M67 67.297H77V120.297H67zM113 81.297H123V173.297H113zM159 134.297H169V226.297H159zM205 187.297H215V265.297H205z" stroke="#A80036" stroke-width="1.0"></path><path d="M26 51.297L26 283.297M72 51.297L72 283.297M118 51.297L118 283.297M164 51.297L164 283.297M210 51.297L210 283.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="5.0,5.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="8" y="47.995">map</text><ellipse cx="26" cy="19" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M22 7L28 2 26 7 28 12 22 7z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="8" y="295.292">map</text><ellipse cx="26" cy="314.594" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M22 302.594L28 297.594 26 302.594 28 307.594 22 302.594z" stroke="#A80036" stroke-width="1.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M54 16H86V46.297H54z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="61" y="35.995">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M54 282.297H86V312.59400000000005H54z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="61" y="302.292">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M100 16H132V46.297H100z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="107" y="35.995">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M100 282.297H132V312.59400000000005H100z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="107" y="302.292">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M146 16H178V46.297H146z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="153" y="35.995">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M146 282.297H178V312.59400000000005H146z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="153" y="302.292">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M192 16H224V46.297H192z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="199" y="35.995">e4</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M192 282.297H224V312.59400000000005H192z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="199" y="302.292">e4</text><path fill="#FFF" filter="url(#prefix__a)" d="M67 67.297H77V120.297H67zM113 81.297H123V173.297H113zM159 134.297H169V226.297H159zM205 187.297H215V265.297H205z" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M55 63.297L65 67.297 55 71.297 59 67.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M26 67.297L61 67.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M101 77.297L111 81.297 101 85.297 105 81.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M26 81.297L107 81.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M37 116.297L27 120.297 37 124.297 33 120.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M31 120.297L71 120.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M147 130.297L157 134.297 147 138.297 151 134.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M26 134.297L153 134.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M37 169.297L27 173.297 37 177.297 33 173.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M31 173.297L117 173.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M193 183.297L203 187.297 193 191.297 197 187.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M26 187.297L199 187.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M37 222.297L27 226.297 37 230.297 33 226.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M31 226.297L163 226.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M37 261.297L27 265.297 37 269.297 33 265.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M31 265.297L209 265.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path></svg>

### Sequential processing

```js
const arr = [1, 2, 3];

const res = await arr.reduce(async (memo, v) => {
	const results = await memo;
	console.log(`S ${v}`)
	await sleep(10);
	console.log(`F ${v}`);
	return [...results, v + 1];
}, []);

// S 1
// F 1
// S 2
// F 2
// S 3
// F 3

console.log(res);
// 2,3,4
```

<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:254px;height:358px" viewBox="0 0 254 358"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="55" y="344.589">Mapping sequentially</text><path fill="#FFF" filter="url(#prefix__a)" d="M86 67.297H96V106.297H86zM132 120.297H142V159.297H132zM178 173.297H188V212.297H178zM224 226.297H234V265.297H224z" stroke="#A80036" stroke-width="1.0"></path><path d="M35 51.297L35 283.297M91 51.297L91 283.297M137 51.297L137 283.297M183 51.297L183 283.297M229 51.297L229 283.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="5.0,5.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="8" y="47.995">reduce</text><ellipse cx="35.5" cy="19" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M31.5 7L37.5 2 35.5 7 37.5 12 31.5 7z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="8" y="295.292">reduce</text><ellipse cx="35.5" cy="314.594" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M31.5 302.594L37.5 297.594 35.5 302.594 37.5 307.594 31.5 302.594z" stroke="#A80036" stroke-width="1.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M73 16H105V46.297H73z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="80" y="35.995">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M73 282.297H105V312.59400000000005H73z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="80" y="302.292">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M119 16H151V46.297H119z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="126" y="35.995">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M119 282.297H151V312.59400000000005H119z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="126" y="302.292">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M165 16H197V46.297H165z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="172" y="35.995">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M165 282.297H197V312.59400000000005H165z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="172" y="302.292">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M211 16H243V46.297H211z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="218" y="35.995">e4</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M211 282.297H243V312.59400000000005H211z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="218" y="302.292">e4</text><path fill="#FFF" filter="url(#prefix__a)" d="M86 67.297H96V106.297H86zM132 120.297H142V159.297H132zM178 173.297H188V212.297H178zM224 226.297H234V265.297H224z" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M74 63.297L84 67.297 74 71.297 78 67.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M35.5 67.297L80 67.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M46.5 102.297L36.5 106.297 46.5 110.297 42.5 106.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M40.5 106.297L90 106.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M120 116.297L130 120.297 120 124.297 124 120.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M35.5 120.297L126 120.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M46.5 155.297L36.5 159.297 46.5 163.297 42.5 159.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M40.5 159.297L136 159.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M166 169.297L176 173.297 166 177.297 170 173.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M35.5 173.297L172 173.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M46.5 208.297L36.5 212.297 46.5 216.297 42.5 212.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M40.5 212.297L182 212.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M212 222.297L222 226.297 212 230.297 216 226.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M35.5 226.297L218 226.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M46.5 261.297L36.5 265.297 46.5 269.297 42.5 265.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M40.5 265.297L228 265.297" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path></svg>

## forEach

https://advancedweb.hu/how-to-use-async-functions-with-array-foreach-in-javascript/

```js
const arr = [1, 2, 3];

arr.forEach(async (i) => {
	// each element takes a different amount of time to complete
	await sleep(10 - i);
	console.log(i);
});

console.log("Finished async");
// Finished async

// 3
// 2
// 1
```



<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:274px;height:454px" viewBox="0 0 274 454"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97" x="89" y="441.253">Async forEach</text><path fill="#FFF" filter="url(#prefix__a)" d="M95 67.297H105V123.297H95zM152 81.297H162V361.961H152zM198 95.297H208V308.828H198zM244 109.297H254V255.695H244z" stroke="#A80036" stroke-width="1.0"></path><path d="M46 51.297L46 379.961M100 51.297L100 379.961M157 51.297L157 379.961M203 51.297L203 379.961M249 51.297L249 379.961" stroke="#A80036" stroke-width="1.0" stroke-dasharray="5.0,5.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M32 16H57V46.297H32z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="11" x="39" y="35.995">js</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M32 378.961H57V409.25800000000004H32z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="11" x="39" y="398.956">js</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="71" y="47.995">forEach</text><ellipse cx="100" cy="19" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M96 7L102 2 100 7 102 12 96 7z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="71" y="391.956">forEach</text><ellipse cx="100" cy="411.258" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M96 399.258L102 394.258 100 399.258 102 404.258 96 399.258z" stroke="#A80036" stroke-width="1.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M139 16H171V46.297H139z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="146" y="35.995">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M139 378.961H171V409.25800000000004H139z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="146" y="398.956">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M185 16H217V46.297H185z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="192" y="35.995">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M185 378.961H217V409.25800000000004H185z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="192" y="398.956">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M231 16H263V46.297H231z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="238" y="35.995">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M231 378.961H263V409.25800000000004H231z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="238" y="398.956">e3</text><path fill="#FFF" filter="url(#prefix__a)" d="M95 67.297H105V123.297H95zM152 81.297H162V361.961H152zM198 95.297H208V308.828H198zM244 109.297H254V255.695H244z" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M83 63.297L93 67.297 83 71.297 87 67.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M46.5 67.297L89 67.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M140 77.297L150 81.297 140 85.297 144 81.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M105 81.297L146 81.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M186 91.297L196 95.297 186 99.297 190 95.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M105 95.297L192 95.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M232 105.297L242 109.297 232 113.297 236 109.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M105 109.297L238 109.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M57.5 119.297L47.5 123.297 57.5 127.297 53.5 123.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M51.5 123.297L99 123.297" stroke="#A80036" stroke-width="1.0"></path><path d="M8 136.297v40h73v-30l-10-10H8" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M71 136.297v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="14" y="153.364">Finished</text><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="14" y="168.497">async</text><path d="M232 215.563v25h29v-15l-10-10h-19" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M251 215.563v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="238" y="232.629">3</text><path d="M186 268.695v25h29v-15l-10-10h-19" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M205 268.695v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="192" y="285.762">2</text><path d="M140 321.828v25h29v-15l-10-10h-19" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M159 321.828v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="146" y="338.895">1</text></svg>

### Waiting for finish

```js
const arr = [1, 2, 3];

await Promise.all(arr.map(async (i) => {
	await sleep(10 - i);
	console.log(i);
}));

// 3
// 2
// 1

console.log("Finished async");
// Finished async
```

<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:268px;height:429px" viewBox="0 0 268 429"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="253" x="3" y="416.253">Async forEach, waiting for the results</text><path fill="#FFF" filter="url(#prefix__a)" d="M87 67.297H97V282.695H87zM133 81.297H143V268.695H133zM179 95.297H189V215.563H179zM225 109.297H235V162.43H225z" stroke="#A80036" stroke-width="1.0"></path><path d="M49 51.297L49 354.961M92 51.297L92 354.961M138 51.297L138 354.961M184 51.297L184 354.961M230 51.297L230 354.961" stroke="#A80036" stroke-width="1.0" stroke-dasharray="5.0,5.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M35 16H60V46.297H35z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="11" x="42" y="35.995">js</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M35 353.961H60V384.25800000000004H35z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="11" x="42" y="373.956">js</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="74" y="47.995">map</text><ellipse cx="92" cy="19" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M88 7L94 2 92 7 94 12 88 7z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="74" y="366.956">map</text><ellipse cx="92" cy="386.258" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M88 374.258L94 369.258 92 374.258 94 379.258 88 374.258z" stroke="#A80036" stroke-width="1.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M120 16H152V46.297H120z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="127" y="35.995">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M120 353.961H152V384.25800000000004H120z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="127" y="373.956">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M166 16H198V46.297H166z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="173" y="35.995">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M166 353.961H198V384.25800000000004H166z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="173" y="373.956">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M212 16H244V46.297H212z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="219" y="35.995">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M212 353.961H244V384.25800000000004H212z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="219" y="373.956">e3</text><path fill="#FFF" filter="url(#prefix__a)" d="M87 67.297H97V282.695H87zM133 81.297H143V268.695H133zM179 95.297H189V215.563H179zM225 109.297H235V162.43H225z" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M75 63.297L85 67.297 75 71.297 79 67.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M49.5 67.297L81 67.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M121 77.297L131 81.297 121 85.297 125 81.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M97 81.297L127 81.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M167 91.297L177 95.297 167 99.297 171 95.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M97 95.297L173 95.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M213 105.297L223 109.297 213 113.297 217 109.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M97 109.297L219 109.297" stroke="#A80036" stroke-width="1.0"></path><path d="M213 122.297v25h29v-15l-10-10h-19" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M232 122.297v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="219" y="139.364">3</text><path fill="#A80036" d="M108 158.43L98 162.43 108 166.43 104 162.43z" stroke="#A80036" stroke-width="1.0"></path><path d="M102 162.43L229 162.43" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path d="M167 175.43v25h29v-15l-10-10h-19" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M186 175.43v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="173" y="192.497">2</text><path fill="#A80036" d="M108 211.563L98 215.563 108 219.563 104 215.563z" stroke="#A80036" stroke-width="1.0"></path><path d="M102 215.563L183 215.563" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path d="M121 228.563v25h29v-15l-10-10h-19" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M140 228.563v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="127" y="245.629">1</text><path fill="#A80036" d="M108 264.695L98 268.695 108 272.695 104 268.695z" stroke="#A80036" stroke-width="1.0"></path><path d="M102 268.695L137 268.695" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M60.5 278.695L50.5 282.695 60.5 286.695 56.5 282.695z" stroke="#A80036" stroke-width="1.0"></path><path d="M54.5 282.695L91 282.695" stroke="#A80036" stroke-width="1.0"></path><path d="M11 295.695v40h73v-30l-10-10H11" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M74 295.695v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="17" y="312.762">Finished</text><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="17" y="327.895">async</text></svg>

### Sequential processing

```js
const arr = [1, 2, 3];

await arr.reduce(async (memo, i) => {
	await memo;
	await sleep(10 - i);
	console.log(i);
}, undefined);

// 1
// 2
// 3

console.log("Finished async");
// Finished async
```

<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:277px;height:429px" viewBox="0 0 277 429"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="258" x="7" y="416.253">Async forEach, sequential processing</text><path fill="#FFF" filter="url(#prefix__a)" d="M93.5 67.297H103.5V282.695H93.5zM149 81.297H159V134.43H149zM195 148.43H205V201.56300000000002H195zM241 215.563H251V268.69599999999997H241z" stroke="#A80036" stroke-width="1.0"></path><path d="M46 51.297L46 354.961M98 51.297L98 354.961M154 51.297L154 354.961M200 51.297L200 354.961M246 51.297L246 354.961" stroke="#A80036" stroke-width="1.0" stroke-dasharray="5.0,5.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M32 16H57V46.297H32z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="11" x="39" y="35.995">js</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M32 353.961H57V384.25800000000004H32z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="11" x="39" y="373.956">js</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="71" y="47.995">reduce</text><ellipse cx="98.5" cy="19" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M94.5 7L100.5 2 98.5 7 100.5 12 94.5 7z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="71" y="366.956">reduce</text><ellipse cx="98.5" cy="386.258" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M94.5 374.258L100.5 369.258 98.5 374.258 100.5 379.258 94.5 374.258z" stroke="#A80036" stroke-width="1.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M136 16H168V46.297H136z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="143" y="35.995">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M136 353.961H168V384.25800000000004H136z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="143" y="373.956">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M182 16H214V46.297H182z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="189" y="35.995">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M182 353.961H214V384.25800000000004H182z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="189" y="373.956">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M228 16H260V46.297H228z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="235" y="35.995">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M228 353.961H260V384.25800000000004H228z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="235" y="373.956">e3</text><path fill="#FFF" filter="url(#prefix__a)" d="M93.5 67.297H103.5V282.695H93.5zM149 81.297H159V134.43H149zM195 148.43H205V201.56300000000002H195zM241 215.563H251V268.69599999999997H241z" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M81.5 63.297L91.5 67.297 81.5 71.297 85.5 67.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M46.5 67.297L87.5 67.297" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M137 77.297L147 81.297 137 85.297 141 81.297z" stroke="#A80036" stroke-width="1.0"></path><path d="M103.5 81.297L143 81.297" stroke="#A80036" stroke-width="1.0"></path><path d="M137 94.297v25h29v-15l-10-10h-19" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M156 94.297v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="143" y="111.364">1</text><path fill="#A80036" d="M114.5 130.43L104.5 134.43 114.5 138.43 110.5 134.43z" stroke="#A80036" stroke-width="1.0"></path><path d="M108.5 134.43L153 134.43" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M183 144.43L193 148.43 183 152.43 187 148.43z" stroke="#A80036" stroke-width="1.0"></path><path d="M103.5 148.43L189 148.43" stroke="#A80036" stroke-width="1.0"></path><path d="M183 161.43v25h29v-15l-10-10h-19" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M202 161.43v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="189" y="178.497">2</text><path fill="#A80036" d="M114.5 197.563L104.5 201.563 114.5 205.563 110.5 201.563z" stroke="#A80036" stroke-width="1.0"></path><path d="M108.5 201.563L199 201.563" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M229 211.563L239 215.563 229 219.563 233 215.563z" stroke="#A80036" stroke-width="1.0"></path><path d="M103.5 215.563L235 215.563" stroke="#A80036" stroke-width="1.0"></path><path d="M229 228.563v25h29v-15l-10-10h-19" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M248 228.563v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="235" y="245.629">3</text><path fill="#A80036" d="M114.5 264.695L104.5 268.695 114.5 272.695 110.5 268.695z" stroke="#A80036" stroke-width="1.0"></path><path d="M108.5 268.695L245 268.695" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><path fill="#A80036" d="M57.5 278.695L47.5 282.695 57.5 286.695 53.5 282.695z" stroke="#A80036" stroke-width="1.0"></path><path d="M51.5 282.695L97.5 282.695" stroke="#A80036" stroke-width="1.0"></path><path d="M8 295.695v40h73v-30l-10-10H8" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M71 295.695v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="14" y="312.762">Finished</text><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="14" y="327.895">async</text></svg>

https://advancedweb.hu/how-to-use-async-functions-with-array-filter-in-javascript/

## filter

### concurrently

```js
const predicate=async (i) => {
	await sleep(10);
	return i % 2 === 0;
}
// concurrently
const asyncFilter = async (arr, predicate) => 
	arr.reduce(async (memo, e) =>
		await predicate(e) ? [...await memo, e] : memo
	, []);
```

<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:394px;height:435px" viewBox="0 0 394 435"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><ellipse cx="117.5" cy="28" filter="url(#prefix__a)" rx="10" ry="10"></ellipse><rect fill="#FEFECE" filter="url(#prefix__a)" height="40" rx="12.5" ry="12.5" width="50" x="181.5" y="8" stroke="#A80036" stroke-width="1.5"></rect><text font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="198" y="32.847">[ ]</text><rect fill="#FEFECE" filter="url(#prefix__a)" height="40" rx="12.5" ry="12.5" width="72" x="170.5" y="125" stroke="#A80036" stroke-width="1.5"></rect><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="175.5" y="149.847">[...[], ...[]]</text><path d="M10 125v40.266h125V149l35.5-4-35.5-4v-6l-10-10H10" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M125 125v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="16" y="142.067">predicate(1) =&gt;</text><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="48" y="157.2">false</text><rect fill="#FEFECE" filter="url(#prefix__a)" height="40" rx="12.5" ry="12.5" width="81" x="166" y="242" stroke="#A80036" stroke-width="1.5"></rect><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="171" y="266.847">[...[], ...[2]]</text><path d="M6 242v40.266h125V266l34.82-4-34.82-4v-6l-10-10H6" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M121 242v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="12" y="259.067">predicate(2) =&gt;</text><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="30" x="44" y="274.2">true</text><rect fill="#FEFECE" filter="url(#prefix__a)" height="40" rx="12.5" ry="12.5" width="81" x="166" y="359" stroke="#A80036" stroke-width="1.5"></rect><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="171" y="383.847">[...[2], ...[]]</text><path d="M6 359v40.266h125V383l34.82-4-34.82-4v-6l-10-10H6" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M121 359v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="12" y="376.067">predicate(3) =&gt;</text><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="44" y="391.2">false</text><ellipse cx="373.5" cy="379" fill="none" filter="url(#prefix__a)" rx="10" ry="10" stroke="#000000" stroke-width="1.0"></ellipse><ellipse cx="374" cy="379.5" rx="6" ry="6"></ellipse><path d="M127.71 28h48.43" fill="none" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M181.26 28L172.26 24 176.26 28 172.26 32 181.26 28z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="146" y="21.067">[ ]</text><path d="M206.5 48.25v71.24" fill="none" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M206.5 124.69L210.5 115.69 206.5 119.69 202.5 115.69 206.5 124.69z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="207.5" y="91.067">1</text><path d="M206.5 165.25v71.24" fill="none" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M206.5 241.69L210.5 232.69 206.5 236.69 202.5 232.69 206.5 241.69z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="207.5" y="208.067">2</text><path d="M206.5 282.25v71.24" fill="none" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M206.5 358.69L210.5 349.69 206.5 353.69 202.5 349.69 206.5 358.69z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="207.5" y="325.067">3</text><path d="M247.35 379h110.67" fill="none" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M363.24 379L354.24 375 358.24 379 354.24 383 363.24 379z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="265.25" y="372.067">Promise([2])</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="159" x="121.5" y="421.995">Async filter with reduce</text></svg>

<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:470px;height:463px" viewBox="0 0 470 463"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="159" x="155" y="450.245">Async filter with reduce</text><path fill="#FFF" filter="url(#prefix__a)" d="M212 112.727H222V267.25800000000004H212zM325 126.727H335V296.39099999999996H325zM438 140.727H448V325.524H438z" stroke="#A80036" stroke-width="1.0"></path><path d="M47 67.594L47 372.656M143 67.594L143 372.656M217 67.594L217 372.656M330 67.594L330 372.656M443 67.594L443 372.656" stroke="#A80036" stroke-width="1.0" stroke-dasharray="5.0,5.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="8" y="64.292">asyncFilter</text><ellipse cx="47.5" cy="35.297" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M43.5 23.297L49.5 18.297 47.5 23.297 49.5 28.297 43.5 23.297z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="8" y="384.651">asyncFilter</text><ellipse cx="47.5" cy="403.953" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M43.5 391.953L49.5 386.953 47.5 391.953 49.5 396.953 43.5 391.953z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="115.5" y="47.995">reduce</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="97" y="64.292">i % 2 === 0</text><ellipse cx="143" cy="19" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M139 7L145 2 143 7 145 12 139 7z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="115.5" y="384.651">reduce</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="97" y="400.948">i % 2 === 0</text><ellipse cx="143" cy="420.25" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M139 408.25L145 403.25 143 408.25 145 413.25 139 408.25z" stroke="#A80036" stroke-width="1.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M199 32.297H231V62.593999999999994H199z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="206" y="52.292">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M199 371.656H231V401.95300000000003H199z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="206" y="391.651">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M312 32.297H344V62.593999999999994H312z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="319" y="52.292">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M312 371.656H344V401.95300000000003H312z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="319" y="391.651">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M425 32.297H457V62.593999999999994H425z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="432" y="52.292">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M425 371.656H457V401.95300000000003H425z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="432" y="391.651">e3</text><path fill="#FFF" filter="url(#prefix__a)" d="M212 112.727H222V267.25800000000004H212zM325 126.727H335V296.39099999999996H325zM438 140.727H448V325.524H438z" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M131 94.727L141 98.727 131 102.727 135 98.727z" stroke="#A80036" stroke-width="1.0"></path><path d="M47.5 98.727L137 98.727" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="54.5" y="93.661">[1, 2, 3]</text><path fill="#A80036" d="M200 108.727L210 112.727 200 116.727 204 112.727z" stroke="#A80036" stroke-width="1.0"></path><path d="M143 112.727L206 112.727" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M313 122.727L323 126.727 313 130.727 317 126.727z" stroke="#A80036" stroke-width="1.0"></path><path d="M143 126.727L319 126.727" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M426 136.727L436 140.727 426 144.727 430 140.727z" stroke="#A80036" stroke-width="1.0"></path><path d="M143 140.727L432 140.727" stroke="#A80036" stroke-width="1.0"></path><path d="M201 153.727v25h257v-15l-10-10H201" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M448 153.727v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="265.5" y="170.793">await predicate(e)</text><path fill="#A80036" d="M346 204.992L336 208.992 346 212.992 342 208.992z" stroke="#A80036" stroke-width="1.0"></path><path d="M340 208.992L437 208.992" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="352" y="203.926">await memo</text><path fill="#A80036" d="M233 234.125L223 238.125 233 242.125 229 238.125z" stroke="#A80036" stroke-width="1.0"></path><path d="M227 238.125L324 238.125" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="239" y="233.059">await memo</text><path fill="#A80036" d="M313 263.258L323 267.258 313 271.258 317 267.258z" stroke="#A80036" stroke-width="1.0"></path><path d="M217 267.258L319 267.258" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="224" y="262.192">[]</text><path fill="#A80036" d="M426 292.391L436 296.391 426 300.391 430 296.391z" stroke="#A80036" stroke-width="1.0"></path><path d="M330 296.391L432 296.391" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="337" y="291.325">[2]</text><path fill="#A80036" d="M154 321.523L144 325.523 154 329.523 150 325.523z" stroke="#A80036" stroke-width="1.0"></path><path d="M148 325.523L442 325.523" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="160" y="320.457">[2]</text><path fill="#A80036" d="M58.5 350.656L48.5 354.656 58.5 358.656 54.5 354.656z" stroke="#A80036" stroke-width="1.0"></path><path d="M52.5 354.656L142 354.656" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="64.5" y="349.59">[2]</text></svg>

sequentially

```
// sequentially
const asyncFilter = async (arr, predicate) => 
	arr.reduce(async (memo, e) => 
		[...await memo, ...await predicate(e) ? [e] : []]
	, []);
```

<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="" style="width:521px;height:542px" viewBox="0 0 521 542"><defs><filter height="300%" id="prefix__a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3"></feBlend></filter></defs><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="302" x="109.5" y="528.511">Async filter with reduce running sequentially</text><path fill="#FFF" filter="url(#prefix__a)" d="M212 112.727H222V267.25800000000004H212zM325 126.727H335V335.524H325zM438 140.727H448V403.78999999999996H438z" stroke="#A80036" stroke-width="1.0"></path><path d="M47 67.594L47 450.922M143 67.594L143 450.922M217 67.594L217 450.922M330 67.594L330 450.922M443 67.594L443 450.922" stroke="#A80036" stroke-width="1.0" stroke-dasharray="5.0,5.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="8" y="64.292">asyncFilter</text><ellipse cx="47.5" cy="35.297" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M43.5 23.297L49.5 18.297 47.5 23.297 49.5 28.297 43.5 23.297z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="8" y="462.917">asyncFilter</text><ellipse cx="47.5" cy="482.219" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M43.5 470.219L49.5 465.219 47.5 470.219 49.5 475.219 43.5 470.219z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="115.5" y="47.995">reduce</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="97" y="64.292">i % 2 === 0</text><ellipse cx="143" cy="19" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M139 7L145 2 143 7 145 12 139 7z" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="115.5" y="462.917">reduce</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="97" y="479.214">i % 2 === 0</text><ellipse cx="143" cy="498.516" fill="#FEFECE" filter="url(#prefix__a)" rx="12" ry="12" stroke="#A80036" stroke-width="2.0"></ellipse><path fill="#A80036" d="M139 486.516L145 481.516 143 486.516 145 491.516 139 486.516z" stroke="#A80036" stroke-width="1.0"></path><path fill="#FEFECE" filter="url(#prefix__a)" d="M199 32.297H231V62.593999999999994H199z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="206" y="52.292">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M199 449.922H231V480.21900000000005H199z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="206" y="469.917">e1</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M312 32.297H344V62.593999999999994H312z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="319" y="52.292">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M312 449.922H344V480.21900000000005H312z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="319" y="469.917">e2</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M425 32.297H457V62.593999999999994H425z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="432" y="52.292">e3</text><path fill="#FEFECE" filter="url(#prefix__a)" d="M425 449.922H457V480.21900000000005H425z" stroke="#A80036" stroke-width="1.5"></path><text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="432" y="469.917">e3</text><path fill="#FFF" filter="url(#prefix__a)" d="M212 112.727H222V267.25800000000004H212zM325 126.727H335V335.524H325zM438 140.727H448V403.78999999999996H438z" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M131 94.727L141 98.727 131 102.727 135 98.727z" stroke="#A80036" stroke-width="1.0"></path><path d="M47.5 98.727L137 98.727" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="54.5" y="93.661">[1, 2, 3]</text><path fill="#A80036" d="M200 108.727L210 112.727 200 116.727 204 112.727z" stroke="#A80036" stroke-width="1.0"></path><path d="M143 112.727L206 112.727" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M313 122.727L323 126.727 313 130.727 317 126.727z" stroke="#A80036" stroke-width="1.0"></path><path d="M143 126.727L319 126.727" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M426 136.727L436 140.727 426 144.727 430 140.727z" stroke="#A80036" stroke-width="1.0"></path><path d="M143 140.727L432 140.727" stroke="#A80036" stroke-width="1.0"></path><path fill="#A80036" d="M346 165.859L336 169.859 346 173.859 342 169.859z" stroke="#A80036" stroke-width="1.0"></path><path d="M340 169.859L437 169.859" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="352" y="164.793">await memo</text><path fill="#A80036" d="M233 194.992L223 198.992 233 202.992 229 198.992z" stroke="#A80036" stroke-width="1.0"></path><path d="M227 198.992L324 198.992" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="239" y="193.926">await memo</text><path d="M147 211.992v25h136v-15l-10-10H147" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M273 211.992v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="153" y="229.059">await predicate(1)</text><path fill="#A80036" d="M313 263.258L323 267.258 313 271.258 317 267.258z" stroke="#A80036" stroke-width="1.0"></path><path d="M217 267.258L319 267.258" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="10" x="224" y="262.192">[]</text><path d="M260 280.258v25h136v-15l-10-10H260" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M386 280.258v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="266" y="297.325">await predicate(2)</text><path fill="#A80036" d="M426 331.523L436 335.523 426 339.523 430 335.523z" stroke="#A80036" stroke-width="1.0"></path><path d="M330 335.523L432 335.523" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="337" y="330.457">[2]</text><path d="M373 348.523v25h136v-15l-10-10H373" fill="#FBFB77" filter="url(#prefix__a)" stroke="#A80036" stroke-width="1.0"></path><path d="M499 348.523v10h10l-10-10" fill="#FBFB77" stroke="#A80036" stroke-width="1.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="379" y="365.59">await predicate(3)</text><path fill="#A80036" d="M154 399.789L144 403.789 154 407.789 150 403.789z" stroke="#A80036" stroke-width="1.0"></path><path d="M148 403.789L442 403.789" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="160" y="398.723">[2]</text><path fill="#A80036" d="M58.5 428.922L48.5 432.922 58.5 436.922 54.5 432.922z" stroke="#A80036" stroke-width="1.0"></path><path d="M52.5 432.922L142 432.922" stroke="#A80036" stroke-width="1.0" stroke-dasharray="2.0,2.0"></path><text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="64.5" y="427.856">[2]</text></svg>